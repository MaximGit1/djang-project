{% extends 'book_storage/base.html' %}
{% load static %}

{% block content %}
<script src="{% static 'book_storage/js/index.js' %}"></script>
<style>
    .card{height:350px}
</style>
{% if message %}<h1>{{ message }}</h1>{% endif %}

<div class="products">
    {%for book_card in page_obj%}
    {% if book_card.is_published %}
  <div class="card">
  <a href="{% url 'book_page' book_card.id %}"><img src="{{ book_card.book_image.url }}" alt="book img"></a>
    <div class="card-body">
      {% if book_card.rating > 0  %}
      <div class="rate green" style="height: 5px; width: 175px; background-color: green"></div>
      {% elif book_card.rating < 0 %}
      <div class="rate red" style="height: 5px; width: 175px; background-color: red"></div>
      {% else %}
      <div class="rate grey" style="height: 5px; width: 175px; background-color: grey"></div>
      {% endif %}
     <h3 class="card-text"><a href="{% url 'book_page' book_card.id %}">{{ book_card.title|truncatechars:35 }}</a></h3>
      <p class="card-text"><a href="{% url 'author_page' book_card.id_author.id %}">{{ book_card.id_author|truncatechars:20 }}</a></p>
    </div>
  </div>
    {% endif %}
    {% endfor %}
</div>

<nav class="pagination">
    <ul>
        {% if page_obj.has_previous %}
            <li>
                <a href="?page=1"><<</a>
            </li>
        {% endif %}
        {% for pn in page_obj.paginator.page_range %}
        <li>
            {% if page_obj.number == pn %}
                <p>{{ pn }}</p>
            {% elif pn >= page_obj.number|add:-2 and pn <= page_obj.number|add:2 %}
                <a href="?page={{ pn }}">{{ pn }}</a>
            {% endif %}
        </li>
        {% endfor %}
        {% if page_obj.has_next %}
            <li>
                <a href="?page={{ page_obj.paginator.num_pages }}">>></a>
            </li>
        {% endif %}
    </ul>
</nav>

{% endblock %}
