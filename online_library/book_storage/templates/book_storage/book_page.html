{% extends 'book_storage/base.html' %}
{% load static %}

{% block content %}
<script src="{% static 'book_storage/js/book_page.js' %}"></script>
<div class="layout_book">

    <div class="FunctionalBlock">
        <ul>
            <li>
                <button type="button" class="FunctionalBlock_button" id="button_save" onclick="alert(`–ö–Ω–∏–≥–∞ {{ book.title }} –æ—Ç–ª–æ–∂–µ–Ω–∞`)">
                    <div class="button">
                        <span class="FunctionalBlock_save_icon">‚ù§</span>
                        <span class="FunctionalBlock_save_text"><a
                                href="{% url 'book_add' book.id %}">–û—Ç–ª–æ–∂–∏—Ç—å</a>></span>
                    </div>
                </button>
                <button type="button" class="FunctionalBlock_button" id="button_readen">
                    {% comment %}
                    <div class="button">
                        <span class="FunctionalBlock_icon">‚úì</span>
                        <span class="FunctionalBlock_save_text">–û—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º</span>
                    </div>
                </button>
                {% endcomment %}
                <button type="button" onclick="showModal()"class="FunctionalBlock_button" id="copyButton">
                    <div class="button">
                        <span class="FunctionalBlock_icon_copy">üîó</span>
                        <span class="FunctionalBlock_save_text">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</span>
                    </div>
                </button>
        </ul>
        <div id="copyForm">
            <input type="button" value="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É" onclick="Copy();" />
            <textarea id="url" rows="1" cols="30"></textarea>
            <button type="button" onclick="history.go(0);">
                <img src="{% static 'book_storage/images/cancel.png' %}" width=45px>
            </button>
        </div>
    </div>
    <div class="book_main">
        <div class="left_info">
            <div class="book_scroll">
            <img src="{{ book.book_image.url }}">
            {% if book.rating > 0 %}
            <div class="rate-green" style="height: 5px; width: 180px; background-color: green"></div>
            {% elif book.rating < 0 %}
            <div class="rate-red" style="height: 5px; width: 180px; background-color: red"></div>
            {% else %}
            <div class="rate-grey" style="height: 5px; width: 180px; background-color: grey"></div>
            {% endif %}
            <br>
            <a href="{% url 'read_page' book.id %}" class="read_fragment">–ß–∏—Ç–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç</a>
        </div></div>
        <div class="center_info">
            <div>
                <h1 id="book_title">{{ book.title }}</h1>
                {% if book.is_verified %}
                    <img src="{% static 'book_storage/images/true.png' %}" width="25px">
                {% else %}
                    <img src="{% static 'book_storage/images/false.png' %}" width="25px">
                {% endif %}
            </div>

            <div class="type_book">
                {% if book.mp3_path %}
                <img src="{% static 'book_storage/images/text_audio.svg' %}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                <div>—Ç–µ–∫—Å—Ç –∏ –∞—É–¥–∏–æ–∫–Ω–∏–≥–∞</div>
                {% else %}
                <img src="{% static 'book_storage/images/text.svg' %}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                <div>—Ç–µ–∫—Å—Ç</div>
                {% endif %}
            </div>
            <div class="seriya">
                {% if book.book_series %}
                <p>–í—Ö–æ–¥–∏—Ç –≤ —Å–µ—Ä–∏—é <b>{{ book.book_series }}</b>:</p>
                {% if ser_books %}
                <button onclick="show_seria()"
                        style="color: blue; font: normal 14px/20px ALS Sirius,Arial,Helvetica Neue,Helvetica,sans-serif;">
                    –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                </button>
                <div class="sh_books" style="display: none;">
                    {% for bk in ser_books %}
                    <a href="{% url 'book_page' bk.pk %}">{{ bk.title }}</a><br>
                    {% endfor %}
                </div>
                {% endif %}
                {% else %}
                <p>–î–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Ü–∏–∫–ª –∫–Ω–∏–≥</p>
                {% endif %}
            </div>
            <h3>–ê–≤—Ç–æ—Ä</h3>
            <div class="author"><a href="{% url 'author_page' book.id_author.id %}">
                {% if author.photo %}
                <img src="{{ author.photo.url }}" , width="40px">
                {% else %}
                <img src="{% static 'book_storage/images/default.jpg' %}" , width="40px">
                {% endif %}</a>
                <a href="{% url 'author_page' book.id_author.id %}">{{ book.id_author }}</a></div>
            <br>
            <p>–†–µ–π—Ç–∏–Ω–≥: {{ book.rating }}</p>
            {% if rate == 1 %}
            <a href="{% url 'book_rating_change' book.id 1 %}"><img
                    src="{% static 'book_storage/images/like-selected.png' %}" width="25px"></a>
            {% else %}
            <a href="{% url 'book_rating_change' book.id 1 %}"><img src="{% static 'book_storage/images/like.png' %}"
                                                                    width="25px"></a>
            {% endif %}
            {% if rate == -1 %}
            <a href="{% url 'book_rating_change' book.id 2 %}"><img
                    src="{% static 'book_storage/images/dislike-selected.png' %}" width="25px"></a>
            {% else %}
            <a href="{% url 'book_rating_change' book.id 2 %}"><img src="{% static 'book_storage/images/dislike.png' %}"
                                                                    width="25px"></a>
            {% endif %}
            <h3>–¢–µ–≥–∏</h3>
            <div class="genres">
                <a href="{% url 'home_type' book.type_of_book.id %}">{{ book.type_of_book }}</a>
                {% for genre in genres %}
                <a href="{% url 'home_genre' genre.id %}">{{ genre }}</a>
                {% endfor %}
            </div>
            <div class="date_of_writing">
                <h3>–î–∞—Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è</h3></div>
            {{ book.writing_year }}
            <div class="publisher">
                <h3>–ò–∑–¥–∞—Ç–µ–ª—å</h3>
                <p>{{ book.id_publisher }}</p>
            </div>

            <div class="description">
                <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <p>{{ book.description }}</p>
            </div>
             <div>
                 <br>
                {% if book.is_verified %}
                <img src="{% static 'book_storage/images/true.png' %}" width="30px">
                <p>–î–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π.</p>
                {% else %}
                <img src="{% static 'book_storage/images/false.png' %}" width="30px">
                <p>–î–∞–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∞ –ø—Ä–æ–≤–µ–∫—É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏.</p>
                <p>–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —ç—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –±—ã–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–∫–∞–∂–µ–Ω–æ. –ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –æ—à–∏–±–∫—É –∏–ª–∏ –≤—ã –∑–∞—Ö–æ—Ç–µ–ª–∏ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∫–Ω–∏–≥—É, —Ç–æ –ø–µ—Ä–µ–π–¥–∏—Ç–µ
                <a href="#">–ü–æ —ç—Ç–æ–π —Å—Å—ã–ª–∫–µ</a> —á—Ç–æ–±—ã —Å–≤—è–∑–∞—Ç—å—Å—è —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–µ–π.</p>
                {% endif %}
            </div>
            {% if request.user.is_authenticated %}
            {% if check %}
            {% include 'book_storage/includes/comment_form.html' %}
            {% endif %}
            {% else %}
            <h4>–ß—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, <a href="{% url 'users:login' %}">–∞–≤—Ç–æ—Ä–∏–∑–∏—Ä—É–π—Ç–µ—Å—å</a></h4>
            {% endif %}


            <div class="comments">
                {% with comments.count as total_comments %}
                <h3>{{ total_comments }} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</h3>
                {% endwith %}
                {% for comment in comments %}
                <div class="comment">
                    <div class="comment-profile">
                    {% if comment.user.avatar %}
                    <a href="{% url 'users:other_profile' comment.user.id %}"><img src="{{ comment.user.avatar.url }}" width="50px"></a>
                    {% else %}
                    <a href="{% url 'users:other_profile' comment.user.id %}"><img src="{% static 'book_storage/images/default.jpg' %}" width="100px"></a>
                    {% endif %}
                    <a href="{% url 'users:other_profile' comment.user.id %}">{{ comment.user.nickname }}</a>
                    </div>
                    {{ comment.text|linebreaks }}
                    {% if request.user.is_authenticated %}
                        {% if request.user.id == comment.user.id %}
                            <a class="comment-delete" href="{% url 'delete_comment' comment.id %}">–£–¥–∞–ª–∏—Ç—å</a>
                        {% endif %}
                    {% endif %}
            
                </div>
                {% empty %}
                <p>–ó–¥–µ—Å—å –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –í—ã –º–æ–∂–µ—Ç–µ —Å—Ç–∞—Ç—å –ø–µ—Ä–≤—ã–º!</p>
                {% endfor %}
            </div>


        </div>
        <div class="right_info">
            <div class="download_links">
            <p><a class="fb2" href="{{ book.fb2_path.url }}">–°–∫–∞—á–∞—Ç—å FB2</a></p>
            {% if book.epub_path %}
            <p><a class="epub" href="{{ book.epub_path.url }}">–°–∫–∞—á–∞—Ç—å EPUB</a></p>
            {% endif %}
            {% if book.mp3_path %}
            <p><a class="mp3" href="{{ book.mp3_path.url }}">–°–∫–∞—á–∞—Ç—å MP3</a></p>
            {% endif %}
        </div>
    </div>
    </div>
</div>


{% endblock %}